---
title: Введение в Spring Framework и его ключевые особенности
date: 2024-01-12 09:00:00 +0300
categories: [Course, Spring]
tags: [spring-course]
---

Spring Framework - это мощный и гибкий фреймворк, который имеет доминирующее положение для написания комплексных
приложений используя языки программирования Java и Kotlin. Данный фреймворк предлагает разработчику комплексный
инструментарий для создания высококачественных, легко тестируемых и масштабируемых приложений. Вот несколько ключевых
особенностей, которые сделали Spring таким популярным:

- **Управление зависимостями:** Spring Framework вводит понятия "Dependency Injection (DI)" (Внедрение зависимостей) и "
  Inversion of Control (IoC)" (Инверсия контроля), позволяя забрать на себя заботу о создании, конфигурации и сборки
  компонентов (управление жизненным циклом), а также дает возможность создавать более модульные и тестируемые
  компоненты.
- **Универсальность:** Spring предлагает поддержку для различных типов приложений, начиная от монолитных веб-приложений
  и заканчивая микросервисами.
- **Абстракции для доступа к данным:** Spring предлагает удобные средства для работы с БД, а с приходом Spring Boot
  простые и удобные варианты построения SQL-запросов.
- **Аспектно-ориентированное программирование (AOP):** Позволяет отделять от бизнес-логики
  инфраструктурные/конфигурационные проблемы (логирование, безопасность или метрики приложения).
- **Непрерывное развитие:** Непрерывное развитие, улучшение и следование актуальным направлениям в разработке (развитие
  spring-boot, WebFlux, Spring Cloud и т.д.) позволяет удерживать Spring свою популярность среди разработчиков.
- **Обширное сообщество:** Огромное сообщество разработчиков и обилие учебных материалов делают изучение Spring
  доступным и практичным, что также удерживает и увеличивает его популярность.

В рамках этого курса мы погрузимся в мир Spring Framework, изучим его основные компоненты, принципы работы и
конфигурации, узнаем как создавать RESTful Web-сервисы, защищать приложение с помощью Spring Security и многое другое.

## История Spring Framework

Как и почему был создан Spring? Какие проблемы он решал на момент своего создания? Почему до сих пор Spring остаётся
лидером?
Spring Framework был создан в 2002 году Родом Джонсоном (Rod Johnson) и позднее состоялся его релиз в 2003 году. Он был
задуман, как более лёгкая и гибкая альтернатива доминировавшей в то время Enterprise JavaBeans (EJB). Проблемы, которые
Spring стремился решить на момент своего создания, включали упрощение корпоративной разработки на Java, улучшение
тестируемости, а также уменьшение связности между компонентами.

Для достижения необходимых улучшений были внедрены такие концепции, как Inversion of Control (IoC - инверсия контроля) и
Dependency Injection (DI - внедрение зависимостей). Эти механизмы позволяют более гибко управлять созданием объектов и
их жизненным циклом. Благодаря чему уменьшается связность между компонентами и улучшается их тестируемость.
Кроме того, Spring также предоставил унифицированный слой абстракции для управления транзакциями, который может работать
с разнообразными API.

## Ключевые особенности Spring Framework

Давайте рассмотрим на примерах, улучшения, которые предлагал Spring и начнём мы с базовых принципов - Dependency
Injection & Inversion of Control.

### Dependency Injection & Inversion of Control

#### Снижение связности между компонентами (DI & IoC)

**Без использования Spring, DI и IoC:**

```java
public class OrderService {
  private InventoryService inventoryService = new InventoryServiceImpl();

  public void processOrder(Order order) {
    if (inventoryService.isAvailable(order.getItem())) {
      // process the order
    }
  }
}
```

В примере выше `OrderService` сильно связан с конкретной реализацией `InventoryService`. Если мы захотим
изменить `InventoryServiceImpl` на другую реализацию, то это потребует изменения кода в классе `OrderService`, что
нарушает принцип открытости/закрытости __(ссылка на этот принцип)__

**С использованием Spring, DI и IoC:**

```java
public class OrderService {
  private InventoryService inventoryService;

  @Autowired
  public OrderService(InventoryService inventoryService) {
    this.inventoryService = inventoryService;
  }

  public void processOrder(Order order) {
    if (inventoryService.isAvailable(order.getItem())) {
      // process the order
    }
  }
}
```

В данном варианте `OrderService` опирается на интерфейс `InventoryService`, а конкретная реализация будет инъецирована
посредством Spring-контейнера (используя IoC & DI). Такой вариант позволяет очень просто подменить
реализацию `InventoryServiceImpl` на любую другую без изменений кода внутри `OrderService`.

#### Улучшение тестирования

**Без Spring, DI и IoC:**

Если мы захотим протестировать `OrderService`, то мы столкнёмся с трудностями, т.к. в тестируемом
классе `OrderServiceTest` нам придётся напрямую инициировать `InventroyServiceImpl`, что в свою очередь усложняет
изоляцию тестируемого сервиса от внутренних компонентов.

**С использованием Spring, DI и IoC:**

Используя DI можно "замокировать" зависимость на `InventoryService`, таким образом при написании теста мы можем
фокусироваться только на поведении `OrderService`, не задумываясь о реализации `InventoryService`. Такой вариант
улучшает поддерживаемость теста и уменьшает его сложность.

```java
public class OrderServiceTest {

  @Test
  public void testProcessOrder() {
    InventoryService mockInventoryService = mock(InventoryService.class);
    when(mockInventoryService.isAvailable(any(Item.class))).thenReturn(true);

    OrderService orderService = new OrderService(mockInventoryService);
    orderService.processOrder(new Order(...));

    // Asserts and verifications
    verify(mockInventoryService).isAvailable(any(Item.class));
  }
}
```

Таким образом, DI и IoC важны, поскольку они способствуют созданию программного обеспечения, которое является более
удобным в обслуживании, масштабируемым и адаптируемым, что является критически важными качествами для разработки
приложений корпоративного уровня.

### Абстракции для доступа к данным (JDBC, ORM, Transactions)

Spring предоставляет высокоуровневый слой абстракции для различных технологий доступа к данным, таким как: JDBC,
Object-Relational Mapping (ORM), а также забирает на себя процесс управления транзакциями.

Каждая из абстракций предоставляет свои преимущества.

#### JDBC абстракция:

- **Управление ресурсами**: Spring управляет JDBC ресурсами, такими как открытие и закрытие соединений с базой данной,
  что помогает предотвратить утечку ресурсов, одну из распространённых ошибок.
- **Обработка исключений**: Spring преобразует SQL-исключения в согласованную иерархию непроверяемых исключений, что
  позволяет разработчикам обрабатывать исключения возникающие при доступе к данным более надежным способом.
- **Уменьшение шаблонного кода**: JdbcTemplate, который предоставляет Spring, упрощает выполнение повторяющихся задач,
  таких как: создание SQL-запросов, проставление параметров и обработку результата выполнения SQL-запроса
- **Консистентность**: Spring предоставляет согласованную модель программирования для различных технологий доступа к
  данным

#### ORM абстракция

- **Интеграция**: Spring предлагает простую интеграцию с популярными ORM-фреймворками (Hibernate, JPA и т.д.)
- **Управление ресурсами**: Spring забирает на себя работу со специфичными для ORM фреймворков ресурсами, такими как
  сессии (в Hibernate) или entityManager (в JPA). Он заботится о жизненном цикле, а также сокращает количество
  шаблонного кода
- **Исключения, возникающие при доступе к данным**: Аналогично JDBC абстракции, исключения, которые порождаются
  ORM-фреймворками преобразуются в "спринговые" исключения (DataAccessException), предлагая разработчику согласованную
  иерархию исключений

#### Транзакционный слой абстракции

- **Декларативные транзакции**: Используя аннотации @Transactional, Spring позволяет осуществлять декларативное
  управление транзакциями, благодаря чему их проще поддерживать, в сравнении с программным управлением транзакциями.
- **Согласованная модель данных**: Spring предоставляет согласованную модель управления транзакциями для различных
  API-интерфейсов (таких, как JDBC, Hibernate или JPA).
- **Поддержка аспектного программирования (AOP)**: Поддержка транзакций реализована с использованием AOP, что означает,
  что транзакционность может быть добавлена в приложение без изменения бизнес-кода (т.е. достаточно просто добавить
  аннотацию @Transactional).

#### Какие плюсы дают все эти слои абстракций?

- **Продуктивность**: Разработчик может сконцентрироваться на бизнес логике, а не разбираться в тонкостях конкретных
  технологий доступа к данным
- **Гибкость**: Благодаря Spring и его абстракциям достаточно легко переключиться на другую технологию доступа к данным
  или изменить стратегию управления транзакциями без существенных изменений в кодовой базе.
- **Тестируемость**: Описанные выше абстракции упрощают написание unit-тестов, т.к. есть возможность замокировать
  базовые ресурсы (DataSource, TransactionManager, ResultSet и т.д.)

Таким образом, Spring Framework упрощает разработку при работе с данными, сокращая объём кода, который необходимо писать
разработчикам, что в свою очередь помогает им создавать более надежные, тестируемые и гибкие приложения.
